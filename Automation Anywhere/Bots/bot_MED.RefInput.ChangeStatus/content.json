{"triggers":[],"nodes":[{"uid":"478ea9b2-6100-4b68-a19c-4550b1a8fc92","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"525c477a-0a2d-4f53-a95f-14eda3732ccf","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"RPA02"}},{"name":"database","value":{"type":"STRING","string":"Robot"}},{"name":"user","value":{"type":"STRING","string":"sa"}},{"name":"auth","value":{"type":"STRING","string":"13May2020"}},{"name":"instance","value":{"type":"STRING","string":"SQLEXPRESS"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e2d33ff6-789e-4da6-94d7-1ff16c1bc539","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numProtocolId$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sProtocolId"}},{"uid":"fba31b09-2086-4ae5-bf34-46edb5d36848","commandName":"subString","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sComment$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"subStringLength","value":{"type":"NUMBER","number":"255"}}],"returnTo":{"type":"VARIABLE","variableName":"sComment"}},{"uid":"09bf553d-9cdd-4bd9-a6f7-b7a57ed88072","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sComment$"}},{"name":"find","value":{"type":"STRING","string":"'"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"''"}}],"returnTo":{"type":"VARIABLE","variableName":"sComment"}},{"uid":"9a1f98b5-791f-4633-9245-939680b3e5e3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"update [FATSQL].[Pt_dcm].[dbo].[petct_napr] set [status]='$sStatus$', [cmnt]='$sComment$' where [protocol_id]=$sProtocolId$"}}],"returnTo":{"type":"VARIABLE","variableName":"sUpdateRequest"}},{"uid":"82a32d3d-19bd-43a4-bd14-11bcee2e6446","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"$sUpdateRequest$"}}]},{"uid":"37413431-6477-4f02-8fb7-70a7994e8ff7","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"5a6470f8-4574-4ea1-8d8f-40821dcab136","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"2020-07-22 Зенин: Добавлено логирование установки статуса в БД FATSQL"}}]},{"uid":"a245b6bb-a74d-44e4-86c9-2b1feaf79f0a","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1fc78753-5cc2-4098-a341-79e7f750ca64","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_SuperviseResearch_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$sUpdateRequest$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}],"branches":[{"uid":"2c7ecbc8-abdd-4476-a77d-fbc67aebbe89","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"ba71e6c2-0d96-45ab-9a93-060ca75380f2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$sUpdateRequest$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"4"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"7"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Установить поля Статус и Комментарий"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"sProtocolId","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numProtocolId","description":"","type":"NUMBER","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sUpdateRequest","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sComment","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sStatus","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sTaskError","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":["9a1f98b5-791f-4633-9245-939680b3e5e3"],"packages":[{"name":"Comment","version":"2.0.0-20200515-071418"},{"name":"Database","version":"2.0.0-20200418-005345"},{"name":"If","version":"2.0.0-20200624-041646"},{"name":"LogToFile","version":"2.0.0-20200515-071509"},{"name":"Number","version":"2.0.0-20200418-005433"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"String","version":"3.0.0-20200418-005635"}],"workItemTemplateName":null}