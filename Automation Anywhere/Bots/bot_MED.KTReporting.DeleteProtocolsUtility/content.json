{"triggers":[],"nodes":[{"uid":"61ef3e68-73e0-4b38-ad86-8f290cb365ec","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"3e1da7b3-1437-43f8-a375-2d412f26bfa3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"Очистка таблицы с обработанными протоколами"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"b3925c0c-a336-4213-a3fc-cf4359b27a2f","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionDeleteProtocols"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"rpa02"}},{"name":"database","value":{"type":"STRING","string":"robot"}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"MED.KTReporting.SQLExpress","lockerName":"MED.KTReporting","attributeName":"Login"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"MED.KTReporting.SQLExpress","lockerName":"MED.KTReporting","attributeName":"Password"}}},{"name":"instance","value":{"type":"STRING","string":"sqlexpress"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"04be8b82-8bc0-4f79-8c52-9e221aa8d345","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionDeleteProtocols"}},{"name":"query","value":{"type":"STRING","expression":"DELETE FROM [Robot].[dbo].[petct_ready] WHERE [dateDICOM] IN ('$iStrDate$')"}}]},{"uid":"de3aaaf1-e32b-4e1b-9b91-880b79882e1e","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionDeleteProtocols"}}]}],"branches":[{"uid":"6d4ebde9-9261-4fb5-88a6-cfce4d03245e","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d37db352-6829-4626-937b-6a4efc5fde7a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Ошибка \"$pStrErrorMessage$\" в строке $pNumErrorLineNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrResult"}},{"uid":"b09b330f-eef5-4f7e-97aa-bf7d127ffb15","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$oStrResult$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"pStrErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"pNumErrorLineNumber"}}},{"uid":"577e3b99-93e7-47d5-ba6f-3cfd6642e803","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"58fc49ad-f2e4-420f-af2e-b5aa6f181992","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Таблица с обработанными протоколами за $iStrDate$ очищена"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"pRecCredentials","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"pStrErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pNumErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"oStrResult","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"iStrDate","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Database","version":"2.0.0-20200515-071421"},{"name":"ErrorHandler","version":"2.0.0-20200515-071432"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"Number","version":"2.0.0-20200515-071522"},{"name":"String","version":"3.0.0-20200515-071729"}],"workItemTemplateName":null}