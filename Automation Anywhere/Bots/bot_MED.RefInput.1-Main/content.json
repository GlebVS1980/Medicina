{"triggers":[],"nodes":[{"uid":"8cb09a85-4921-4613-923d-a9ae5bfa8165","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"INFO: Запущен процесс проверки пациентов в ЕРИС\n====================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"72502c94-70f1-420c-aebe-b45aeb484486","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dtCurrentTime"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd MM yy--hh:mm"}}],"returnTo":{"type":"VARIABLE","variableName":"pstrStartTime"}},{"uid":"db70edb5-222e-45a3-bd48-cbb8c6cf6a69","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"c3284850-659e-47bc-886e-15865935dac5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e3a94158-75cd-452c-a8b9-a174388751ba","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"37d0978d-1d16-4468-8895-2a475dcbd93f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"!!!!Превышено макс. число перезагрузок подряд. Выход!!!"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"43d83d35-c183-4894-91bc-bcf7371d5535","commandName":"logoff","packageName":"System","disabled":false},{"uid":"44a031b9-eb83-436c-88c4-d639eab3060a","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$pNumReloadCounter$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"2"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"78b63412-a869-41bc-95e2-040b8225a1c4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f4c51482-4f9b-4382-b9e0-3789cbe1d774","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"pBoolReload"}},{"uid":"abf9943c-2a3e-4ed2-9a96-3b69e6d4d742","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"pStrLogFilePath","value":{"type":"STRING","string":"C:\\Robot\\Logs\\VPN_log.txt"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.RefInput.ConnectVPN3"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"41decc60-078e-489a-aa32-0a30275abfed","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"INFO: Завершено подключение к ВПН"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"546b8378-af0d-4440-b6d0-390472dbc509","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"38ceb7c3-73ce-4e79-9f5f-d707d4436e2a","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dCurrentDate"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd.MM.yyyy"}}],"returnTo":{"type":"VARIABLE","variableName":"sCurrentDateForRecord"}},{"uid":"7f9a5dc7-0a98-45a6-97ee-b9fbd6fd825c","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dCurrentDate"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"E dd.MM.yyyy"}}],"returnTo":{"type":"VARIABLE","variableName":"sCurrentDatePlusDayOfWeek"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Определение текущей даты"}}]},{"uid":"9ecf4e99-1f35-4814-95ec-750f4ba61529","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5fc16d77-715c-4e1e-8eb3-148f65558ce4","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Med.Refinput-EmiasLogin"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"pEmiasLoginInput"}},{"uid":"8d046f42-41eb-47e0-85e6-904eca797408","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"62145ec3-9d3a-47c4-98c2-eb054ee4af86","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"Окно подключения к ЕМИАС недоступно"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$pEmiasLoginInput{LogStatus}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Not Logged"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"4a531a2a-d73a-4143-b7f6-83659a217ea0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"INFO: Завершено подключение к ЕРИС"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Запуск приложений EMIAS Login"}}]},{"uid":"23c446c8-ae1e-44bd-9d1d-0c53ba389aac","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fa1a26d4-bc6d-4c7f-9603-b9a2acd00a3b","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"rpa02\\sqlexpress"}},{"name":"database","value":{"type":"STRING","string":"Robot"}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"DB_Login","lockerName":"DB_Login","attributeName":"Login"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"DB_Password","lockerName":"DB_Login","attributeName":"Password"}}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"3106a5c7-986e-48cc-96f7-d53b29c5bfb1","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"$pStrQuery$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sDBListFileAddress$"}},{"name":"encodingType","value":{"type":"STRING","string":"UTF8"}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]},{"uid":"67d2c497-5f13-4487-a767-e1ecb7cb752a","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"030dec0f-ebc8-449d-a87f-0a6514822e0c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"INFO: Считан перечень пациентов в БД"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Получение данных пациентов из БД"}}]},{"uid":"0091916a-fd50-4282-ae1b-02f5dab00b96","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"c66212b5-f540-4d81-9f00-87b7d05a6213","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"1"}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Data/Patients.csv"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"afb316d1-b9c0-4cd9-a250-fd38ff98172c","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"d90d27e5-08c1-4bce-97c5-42b841145e4e","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nTotalPatientsToProcess$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nTotalPatientsToProcess"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"CsvTxtRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"1"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.csvtxt","packageName":"CsvTxt"}}]},{"uid":"7fa80583-675c-42f0-ba95-e6e1da974004","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"1"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Получение числа пациентов для обработки, ввод даты в Мастер файл отчета Эксель"}}]},{"uid":"b30d8bd6-b0f1-41f0-9aa2-5efbc18dfc97","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"9492d0db-22a4-42c4-b9da-3ecdd29086db","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Определяется адрес пустой строки в Эксель\nвводится дата с днем недели"}}]},{"uid":"9ba7f02e-e2c7-4a72-ad14-84ea3da54d56","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sMasterRecordExcelAddress$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"uid":"ab87b6f6-3357-4082-b6a1-78dc2cb7592e","commandName":"GetMultipleCells","packageName":"Excel","disabled":false,"attributes":[{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"tMasterExcelContent"}},{"uid":"fdea3c51-53a2-471f-ac3e-44bfae0cb1dc","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"90c00623-a553-46f2-bedd-a85d3bae048d","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nExcelRawCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nExcelRawCounter"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rExcelLineRecord"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"tMasterExcelContent"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"c698f4ba-b4b4-4b45-a3c9-a3331487c43a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Определяется адрес пусой строки"}}]},{"uid":"47bebafb-532d-4554-b222-c782c22295da","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nExcelRawCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nExcelRawCounter"}},{"uid":"ca8f36f6-307b-4737-af2a-196637c22486","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nExcelRawCounter$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sExcelEmptyCell"}},{"uid":"b4c166f6-8640-44de-bc93-34559317273e","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"A$sExcelEmptyCell$"}},{"name":"value","value":{"type":"STRING","expression":"$sCurrentDatePlusDayOfWeek$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"5884f91c-59ca-4f59-930f-bd645bf4623b","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nExcelRawCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nExcelRawCounter"}},{"uid":"10807369-1a01-4e92-8a4d-58b90840c1f1","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nExcelRawCounter$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sExcelEmptyCell"}},{"uid":"c2a78d66-64d5-4041-9088-22fd20a480a4","commandName":"CloseSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Определение пустой строки для записи в Мастер отчет, ввод даты и дня недели"}}]},{"uid":"6cb98f46-6957-4703-aa28-805edfc59599","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"225d3d1d-52d6-4438-85c4-e9b209cec6f9","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"INFO: Запущен цикл проверки пациентов в ЕРИС"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"95bbe75d-54fa-4bbd-add0-644e8dc62b83","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Data/Processed%20patients.txt"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"596eefad-ff82-4571-a938-7e27e7b3bcab","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sDBListFileAddress$"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"91a3a638-b1df-4862-82b3-b8ffc0d63e16","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"9cff24b5-c3bd-4ac7-98b4-544a94a31986","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$pPatientDataRawRecord[0]$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"1"}}]},{"uid":"2d271933-554d-47a8-80e0-c7bc3a645fdc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pPatientDataRawRecord[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sProtokolID"}},{"uid":"48fb5adf-1e85-4cf9-a5bb-610c01182d37","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pPatientDataRawRecord[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sFIO"}},{"uid":"825e3a43-9ee1-4469-8672-8ffbc23a9de5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pPatientDataRawRecord[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sBirthDate"}},{"uid":"1b3cd6ee-4b7d-44b9-a494-c140507f800f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pPatientDataRawRecord[3]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sPolicyNum"}},{"uid":"7e0f043b-f6e6-423a-95de-1752516165f8","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"sPolisNum","value":{"type":"STRING","expression":"$sPolicyNum$"}},{"key":"sProtocolId","value":{"type":"STRING","expression":"$sProtokolID$"}},{"key":"sBirthday","value":{"type":"STRING","expression":"$sBirthDate$"}},{"key":"sFIO","value":{"type":"STRING","expression":"$sFIO$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.RefInput.3-Emias"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"dictERISCheckStatus"}},{"uid":"6f40fefa-c6d1-432d-a421-d25de48e8b71","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"248ad09b-8e44-48dd-9a48-7315ff6065ef","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nTotalPatientsError$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nTotalPatientsError"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$dictERISCheckStatus{sSearchStatus}$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"ошибка"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"3b169f27-a596-4e69-914d-a54896f2a2e7","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sMasterRecordExcelAddress$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"uid":"7060763f-66db-448c-9c47-2696293ef716","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"A$sExcelEmptyCell$"}},{"name":"value","value":{"type":"STRING","expression":"$sCurrentDateForRecord$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"b188cbfd-0b50-485f-8c4b-c9abfad705a2","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"B$sExcelEmptyCell$"}},{"name":"value","value":{"type":"STRING","expression":"$sProtokolID$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"bca06265-aace-4b94-9d41-feabd40b6bf1","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"C$sExcelEmptyCell$"}},{"name":"value","value":{"type":"STRING","expression":"$sFIO$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"46cf2b46-a9e2-4323-8865-cd4b98d60d77","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"D$sExcelEmptyCell$"}},{"name":"value","value":{"type":"STRING","expression":"$sBirthDate$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"1cba7445-a8ce-4cd8-995a-c20657cb8cd1","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"E$sExcelEmptyCell$"}},{"name":"value","value":{"type":"STRING","expression":"$sPolicyNum$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"a5062a3c-48d9-4ab4-912a-ef2d98c5f713","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"F$sExcelEmptyCell$"}},{"name":"value","value":{"type":"STRING","expression":"$dictERISCheckStatus{sSearchStatus}$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}]},{"uid":"f81faef3-24b6-4c8a-89fb-e1017fbd84de","commandName":"CloseSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]},{"uid":"53932e12-2a2e-406b-ac39-bc1afabd2c52","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"033f7f95-8347-417b-b614-ee8860715cf4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Data/Processed%20patients.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$sProtokolID$; $sFIO$; $sBirthDate$; $sPolicyNum$; $dictERISCheckStatus{sSearchStatus}$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Запись данных обработанных пациентов"}}]},{"uid":"2575fe72-b705-4e9c-b848-719eab567a88","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nExcelRawCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nExcelRawCounter"}},{"uid":"b9d2ff20-ae9e-4616-b779-2f6f987e10df","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nExcelRawCounter$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sExcelEmptyCell"}},{"uid":"b022db0d-429d-4d0d-9f99-b8ac6736a1cc","commandName":"if","packageName":"If","disabled":true,"children":[],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$pPatientDataRawRecord[0]$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pPatientDataRawRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.csvtxt","packageName":"CsvTxt"}}]},{"uid":"7fbce30f-186b-4285-b1f6-71660435abac","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"2ee636e9-7423-4f32-b08a-2b06f9a57af1","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"INFO: Процесс проверки пациентов в ЕРИС завершен"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"5ca58a91-51fe-4107-a365-8201184927ed","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dtEndTime"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd MM yy"}}],"returnTo":{"type":"VARIABLE","variableName":"pstrEndTime"}},{"uid":"be36b192-fa82-4845-b1ad-6d36ca74a07c","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$System:Hour$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrHour"}},{"uid":"bf38ab76-81ad-4481-a86d-180e142a4744","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$System:Minute$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrMin"}},{"uid":"3364c4ed-fe58-4249-b0a2-098f441c0b1f","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nTotalPatientsToProcess$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrTotalPatients"}},{"uid":"d4b4b3b6-64d2-487e-9d02-2a06a4006eb8","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nTotalPatientsError$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrErrorPatients"}},{"uid":"fee2b671-f971-46de-9f6c-4668a580fde5","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"lopatin.s@medicina.ru"}},{"name":"cc","value":{"type":"STRING","expression":"$@pStrAdtSupport$;alexander.maximov@adt2b.ru"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"Процесс КТ. Отчет о работе на $pstrEndTime$."}},{"name":"attachmentsFilePath","value":{"type":"FILE","string":"file:///C:/Robot/Data/Processed%20patients.txt"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"\n\nПроцесс ПЭТ КТ завершил работу.\nПоступили и обработаны данные $pStrTotalPatients$ пациентов.\nОбработаны с ошибками - $pStrErrorPatients$ пациентов.\nОбработка данных начата - $pstrStartTime$.\nОбработка данных завершена - $pstrEndTime$--$pStrHour$:$pStrMin$.\nПодробности работы робота - http://rpa02.medimain.ru/#/activity/historical\n\nПеречень обработанных значений в приложенном файле.\nМастер файл перечня обработанных сообщений находится по адресу\nC:\\Robot\\Мастер отчет о работе робота процесс ПЭТ КТ.xlsx\n\n\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$@pStrRobotEmailAdd$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@pStrMailServerAddress$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@pNumEmailServerPort$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"RobotEmailLogiin","lockerName":"RpaRobotEmailCred","attributeName":"Robot Email Login"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"RobotEmailPass","lockerName":"RpaRobotEmailCred","attributeName":"Email pass"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Цикл проверки пациентов"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Подготовка данных, проверка пациентов"}}]}],"branches":[{"uid":"c4636b6c-0655-47d6-a291-b961c1a17e16","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"381b818f-5722-4233-8ea1-eb3489bdb41e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$sTaskLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLineNumber"}},{"uid":"79ddcdaa-d1d2-459e-b160-84cb193222ac","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"ERROR: Во время выполнения процесса произошла ошибка '$sTaskError$' в строке $sErrorLineNumber$."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"4b647bdf-3209-4491-bd06-204753e61cc1","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$@pStrAdtSupport$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Внимание! Ошибка в процессе MED.Refinput.1-Main"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"ERROR: Возникла ошибка при обработке пациента - $sPolisNum$. \nОшибка - $sErrorMsg$, строка - $sErrorLineNumber$.\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$@pStrRobotEmailAdd$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@pStrMailServerAddress$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@pNumEmailServerPort$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"RobotEmailLogiin","lockerName":"RpaRobotEmailCred","attributeName":"Robot Email Login"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"RobotEmailPass","lockerName":"RpaRobotEmailCred","attributeName":"Email pass"}}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sTaskError"},"errorLineNumber":{"type":"VARIABLE","variableName":"sTaskLineNumber"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"WHILE"}},{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$pBoolReload$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}},{"name":"checkConditionAtEnd","value":{"type":"BOOLEAN","boolean":true}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"recCurrentRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"datatableNaprRecords","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[],"rows":[{"values":[]}]}}},{"name":"RecordsCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"queryGetNapr2","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[View_GetNapr_Prod] WHERE eris_l="}},{"name":"datatableWrf","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"sCurrentWrf","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"recordCurrentWrf","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"dictParams","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dtConfigParams","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"name":"Name","type":"STRING"},{"name":"Value","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"recParam","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"sParamValue","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sPrevValue","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sTaskError","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sTaskLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrorLineNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pBoolReload","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"window-1","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Agfa HealthCare Enterprise Imaging","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre32_1.8.0.171\\bin\\javaw.exe","class":"SunAwtFrame","handle":"66106","isChild":false,"location":{"top":-32000,"left":-32000},"size":{"height":28,"width":160},"presetType":"NONE"}}},{"name":"window-2","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Диагностический рабочий стол*","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtFrame","handle":"66320","isChild":false,"location":{"top":0,"left":0},"size":{"height":1000,"width":1660},"presetType":"NONE"}}},{"name":"window-3","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"EMIAS - Log In*","path":"C:\\Program Files\\Internet Explorer\\iexplore.exe","class":"IEFrame","handle":"66350","isChild":false,"location":{"top":26,"left":26},"size":{"height":875,"width":1156},"presetType":"NONE"}}},{"name":"window-4","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Пациенты*","path":"C:\\Program Files\\Internet Explorer\\iexplore.exe","class":"IEFrame","handle":"66350","isChild":false,"location":{"top":-32000,"left":-32000},"size":{"height":28,"width":160},"presetType":"NONE"}}},{"name":"window-5","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Добавить продукт","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtDialog","handle":"6030352","isChild":false,"location":{"top":304,"left":602},"size":{"height":402,"width":477},"presetType":"NONE"}}},{"name":"window-15","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Добавить продукт","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtDialog","handle":"7735738","isChild":false,"location":{"top":305,"left":602},"size":{"height":402,"width":477},"presetType":"NONE"}}},{"name":"window-16","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Редактировать продукт","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtDialog","handle":"13765078","isChild":false,"location":{"top":385,"left":599},"size":{"height":239,"width":481},"presetType":"NONE"}}},{"name":"pBoolFirstRun","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"pStrReloadFlag","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"window-6","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"","path":"C:\\Windows\\explorer.exe","class":"NotifyIconOverflowWindow","handle":"65722","isChild":false,"location":{"top":930,"left":1401},"size":{"height":80,"width":80},"presetType":"NONE"},"expression":""}},{"name":"window-7","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre32_1.8.0.171\\bin\\javaw.exe","class":"SunAwtWindow","handle":"327828","isChild":false,"location":{"top":963,"left":1420},"size":{"height":26,"width":43},"presetType":"NONE"},"expression":""}},{"name":"window-8","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre32_1.8.0.171\\bin\\javaw.exe","class":"SunAwtWindow","handle":"787308","isChild":false,"location":{"top":962,"left":1421},"size":{"height":26,"width":133},"presetType":"NONE"},"expression":""}},{"name":"pStrAgfaPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre32_1.8.0.171\\bin\\javaw.exe"}},{"name":"window-9","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"*Microsoft Outlook","path":"C:\\Program Files (x86)\\Microsoft Office\\Office12\\OUTLOOK.EXE","class":"rctrl_renwnd32","handle":"328474","isChild":false,"location":{"top":-32000,"left":-32000},"size":{"height":28,"width":160},"presetType":"NONE"}}},{"name":"pNumReloadCounter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"pStrQuery","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"select \n\tprotocol_id\n\t, fio\n\t, p_birth\n\t, lTrim(rTrim(isNull(oms_polis_serial, ''))) + lTrim(rTrim(isNull(oms_polis_num, ''))) as polisnum\nfrom openquery ([FATSQL], '\nSelect\n\ta.protocol_id\n\t, a.fio\n\t, convert(varchar(10), a.person_birthday, 104) p_birth\n\t, a.oms_polis_serial\n\t, a.oms_polis_num\nfrom \n\tpt_dcm.dbo.petct_napr a \n\tjoin pt_dcm.dbo.petct_oms b on a.protocol_id = b.protocol_id\nwhere 0=0\n\tand a.protocol_id > 1024\n\tand isNull(a.[status], 0) = 0\n   \tand b.dateDICOM > cast(dateadd(day, -15, getdate()) as date)\n\tand exists (select 0 from pt_dcm.dbo.petct_protocol c where c.protocol_id = a.protocol_id)\n') as PatientList\n\n"}},{"name":"pDateTo","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"pStrDateTo","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrGlobalDateFilterProc1","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pPatientListTable","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"pPatientDataRawRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"pEmiasLoginInput","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sProtokolID","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sFIO","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sBirthDate","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sPolicyNum","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sITPersonEmail","description":"Адрес ответственного сотрудника IT","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"tech@adt2b.ru;alexander.maximov@adt2b.ru"}},{"name":"sPolisNum","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"7154440828000023"}},{"name":"sErrorMsg","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"nTotalPatientsToProcess","description":"Число пациентов для обработки","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nTotalPatientsProcessed","description":"Число обработанных пациентов","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nTotalPatientsError","description":"Число необработанных пациентов - ошибка в ЕРИС","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sDBListFileAddress","description":"Адрес файла, содержащего выгруженных из БД пациентов","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Robot\\Data\\Patients.csv"}},{"name":"CsvTxtRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"dictERISCheckStatus","description":"Словарь получение данных проверки пациентов","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sMasterRecordExcelAddress","description":"Адрес мастер файла отчета работы робота","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Robot\\Мастер отчет о работе робота процесс ПЭТ КТ.xlsx"}},{"name":"tMasterExcelContent","description":"Таблица содержания мастер файла отчета робота","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"rExcelLineRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"nExcelRawCounter","description":"Число заполненных строк в Эксель","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"1"}},{"name":"sCellAddressToFill","description":"Адрес пустой строки для заполнения","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dCurrentDate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"sCurrentDatePlusDayOfWeek","description":"Текущая дата с днем недели","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sCurrentDateForRecord","description":"Дата используемая для строк в отчетности","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sExcelEmptyCell","description":"Адрес пустой строки для заполнения в формате строки","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sProcessedList","description":"Перечень обработанных пациентов для отчета в почте","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dtCurrentTime","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"pstrStartTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pstrEndTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrTotalPatients","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrErrorPatients","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dtEndTime","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"pStrHour","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrMin","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["4a531a2a-d73a-4143-b7f6-83659a217ea0","7060763f-66db-448c-9c47-2696293ef716"],"packages":[{"name":"CsvTxt","version":"2.4.0-20210227-025429"},{"name":"If","version":"2.0.0-20200515-071441"},{"name":"TaskBot","version":"2.0.0-20200417-230837"},{"name":"Database","version":"2.0.0-20200418-005345"},{"name":"Excel","version":"2.6.0-20210322-131557"},{"name":"Datetime","version":"2.0.0-20200624-041628"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"Comment","version":"2.0.0-20200418-005342"},{"name":"Boolean","version":"2.0.0-20200515-071408"},{"name":"ErrorHandler","version":"2.0.0-20200418-005357"},{"name":"MessageBox","version":"2.0.0-20200418-005424"},{"name":"System","version":"2.0.0-20200624-042146"},{"name":"String","version":"3.0.0-20200418-005635"},{"name":"DataTable","version":"2.0.0-20200418-005637"},{"name":"File","version":"4.0.0-20210504-152837"},{"name":"Loop","version":"2.0.0-20200418-005424"},{"name":"Number","version":"2.0.0-20200418-005433"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"Email","version":"3.4.0-20210316-122358"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"improvedNumberSupport":false,"automationPriority":"PRIORITY_MEDIUM","botCodeVersion":"1"}}