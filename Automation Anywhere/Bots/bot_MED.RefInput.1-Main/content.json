{"triggers":[],"nodes":[{"uid":"8cb09a85-4921-4613-923d-a9ae5bfa8165","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"=============================\nЗапуск робота \"Заведение направлений\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"db70edb5-222e-45a3-bd48-cbb8c6cf6a69","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"c3284850-659e-47bc-886e-15865935dac5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"78b63412-a869-41bc-95e2-040b8225a1c4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f4c51482-4f9b-4382-b9e0-3789cbe1d774","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"pBoolReload"}},{"uid":"abf9943c-2a3e-4ed2-9a96-3b69e6d4d742","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"pStrLogFilePath","value":{"type":"STRING","string":"C:\\Robot\\Logs\\MED_RefInput_Log.txt"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.RefInput.ConnectVPN"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"1e5f7ac8-54fa-4f2d-ad63-368e4ba59aaf","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"6f28b839-a24d-4e32-a284-be429377d81e","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Config/MEDRobotConfig.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":true}},{"name":"sheetName","value":{"type":"STRING","string":"Assets"}},{"name":"fileAccessMode","value":{"type":"STRING","string":"READ_ONLY"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"9b6099d2-a3c6-4cab-a26b-19f4b869362e","commandName":"getWorksheetAsDataTable","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"sheetSelection","value":{"type":"STRING","string":"ActiveWorksheet"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"dtConfigParams"}},{"uid":"0dfa3d1f-7e6b-4c39-8c1f-a3eee2a94af7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"a491df90-99d3-4c11-be93-1fee29e6e440","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$recParam[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sParamValue"}},{"uid":"c0618282-cf1c-47b2-8345-e2493cdef502","commandName":"put","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dictParams"}},{"name":"key","value":{"type":"STRING","expression":"$recParam[0]$"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"sParamValue"}}],"returnTo":{"type":"VARIABLE","variableName":"sPrevValue"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recParam"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"dtConfigParams"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"93b134fa-bc77-48d3-ab0f-85305ee0a0ba","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Чтение конфигуратора"}}]},{"uid":"7611054b-990b-4240-a79c-66ea18a22590","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"09aa136c-218b-4d89-82a3-b400d6fd2962","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Получение перечня врачей из БД"}}]},{"uid":"78028a77-dd19-4eea-b7c7-15432cf63197","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionURL","value":{"type":"STRING","string":"jdbc:sqlserver://rpa02;instanceName=sqlexpress;databaseName=robot;user=sa;password=13May2020;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Config/mssql-jdbc-8.2.2.jre11.jar"}}]},{"uid":"57abeacd-f06f-4842-b52e-653e4e241347","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}},{"name":"query","value":{"type":"STRING","string":"Select distinct(eris_l) from [Robot].[dbo].[View_GetNapr_Prod]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"85f211e8-7a2f-4972-ac21-f0cf9c0e287a","commandName":"assign","packageName":"DataTable","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"table"}},{"name":"sourceTable","value":{"type":"TABLE","table":{"schema":[{"name":"eris_l","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}}],"returnTo":{"type":"VARIABLE","variableName":"datatableWrf"}},{"uid":"6471c6c0-4612-426a-8613-36c20b1cfdcc","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"Получен список врачей"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"8b50a765-8cc2-44a1-8d71-4f33e1e4f336","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Цикл по врачам"}}]},{"uid":"a097ed94-38b2-4894-a208-26e3e99bbed7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"044de97b-88a5-4dc1-b70f-e807e7a54e43","commandName":"insertRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableWrf"}},{"name":"positionSelection","value":{"type":"STRING","string":"lastPosition"}},{"name":"rowRecord","value":{"type":"VARIABLE","variableName":"recCurrentRow"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recCurrentRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"5b1c267a-2b9e-4d17-883b-bba4a1633acc","commandName":"deleteRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableWrf"}},{"name":"inputPosition","value":{"type":"NUMBER","number":"0"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Чтение данных из БД"}}]},{"uid":"8aad44bd-b0a6-458e-98b2-e2cc3b8e2228","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Цикл по врачам"}}]},{"uid":"9ecf4e99-1f35-4814-95ec-750f4ba61529","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"92a10846-9c45-4fb8-b9cb-12ff2f539cbe","commandName":"launchWebsite","packageName":"Browser","disabled":false,"attributes":[{"name":"url","value":{"type":"STRING","string":"https://ps.eris.moscow/apex/f?p=113:LOGIN_DESKTOP:14544101294074:::::"}},{"name":"browser","value":{"type":"STRING","string":"INTERNET_EXPLORER"}}]},{"uid":"31b2cb4b-2f69-443a-9292-d0451da99ef4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"99725576-4ff8-4116-8e66-eccde31d38cd","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/ProgramData/AGFA/IMPAX%20Agility/com.oracle.jre32_1.8.0.171/bin/javaw.exe"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":"-jar \"C:\\ProgramData\\AGFA\\IMPAX Agility\\cache\\com.agfa.agility.netboot_1.0.1500.R812_v20180718_0743.jar\" \"eihub02apps.eris.local\""}}]},{"uid":"14cd6965-78b9-44d7-adf8-93ef5a000a7b","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"pBoolFirstRun"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$pBoolFirstRun$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Запуск приложений"}}]},{"uid":"00d09cd3-0090-4bae-b48e-7a28353c8536","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"4f18219d-6756-4027-bbe2-0dd46228b3c0","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}},{"name":"query","value":{"type":"STRING","expression":"$queryGetNapr2$'$recordCurrentWrf[0]$'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"50166f9c-38cf-4d5a-a821-1cb7e65360cd","commandName":"assign","packageName":"DataTable","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"table"}},{"name":"sourceTable","value":{"type":"TABLE","table":{"schema":[{"name":"protocol_id","type":"STRING"},{"name":"histnum","type":"STRING"},{"name":"fio","type":"STRING"},{"name":"datpri","type":"STRING"},{"name":"wrf","type":"STRING"},{"name":"user_fullname","type":"STRING"},{"name":"eris_l","type":"STRING"},{"name":"eris_p","type":"STRING"},{"name":"kod","type":"STRING"},{"name":"schname","type":"STRING"},{"name":"diagza","type":"STRING"},{"name":"mkb_name","type":"STRING"},{"name":"person_birthday","type":"STRING"},{"name":"pol","type":"STRING"},{"name":"oms_polis_serial","type":"STRING"},{"name":"oms_polis_num","type":"STRING"},{"name":"oms_sk_name","type":"STRING"},{"name":"pet_device","type":"STRING"},{"name":"status","type":"STRING"},{"name":"cmnt","type":"STRING"},{"name":"oms_polis_custom","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}}],"returnTo":{"type":"VARIABLE","variableName":"datatableNaprRecords"}},{"uid":"e52bd9b8-cc26-4818-a514-e283508da33b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Цикл по направлениям"}}]},{"uid":"0deef8c1-d7ee-4d03-9c6c-732eb25d4458","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5422c957-3e1f-4b58-b660-804e5ced33d0","commandName":"insertRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableNaprRecords"}},{"name":"positionSelection","value":{"type":"STRING","string":"lastPosition"}},{"name":"rowRecord","value":{"type":"VARIABLE","variableName":"recCurrentRow"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recCurrentRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"ff6b9fe4-c316-4710-8fb9-d83ace5498d3","commandName":"toString","packageName":"Number","disabled":true,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$datatableNaprRecords.DataTable:rowCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"RecordsCount"}},{"uid":"c5e8b85a-d58b-4c4c-8968-ef35bc86121a","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5cc0c9e9-de97-4d49-ab31-335e40c9af2e","commandName":"deleteRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableNaprRecords"}},{"name":"inputPosition","value":{"type":"NUMBER","number":"0"}}]},{"uid":"047fafd0-765f-4ae2-a5b6-2bb44c2c7540","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Запуск подтверждения"}}]},{"uid":"dd4b7d53-3328-4676-aa8f-661dcd9272e6","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"dtNapr","value":{"type":"TABLE","expression":"$datatableNaprRecords$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.RefInput.2-SearchImaging"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$datatableNaprRecords.DataTable:rowCount$"}},{"name":"operator","value":{"type":"STRING","string":"GT"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"ccc90c2d-a6df-4d02-b75c-1b7866dfde1e","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Логин  $recordCurrentWrf[0]$ - $RecordsCount$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recordCurrentWrf"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"datatableWrf"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Подготовка данных"}}]}],"branches":[{"uid":"c4636b6c-0655-47d6-a291-b961c1a17e16","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"381b818f-5722-4233-8ea1-eb3489bdb41e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$sTaskLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLineNumber"}},{"uid":"fd757c7e-b6df-40a0-8c40-f2c6f3040ba5","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Во время выполнения процесса произошла ошибка '$sTaskError$' в строке $sErrorLineNumber$. Обратитесь к Администратору процесса."}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"79ddcdaa-d1d2-459e-b160-84cb193222ac","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Во время выполнения процесса произошла ошибка '$sTaskError$' в строке $sErrorLineNumber$."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"26a5e633-d870-4604-b830-ed3cc49e2236","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Закрыть окна"}}]},{"uid":"781f409c-bb06-43e3-a6ce-f7b7a95864a7","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3832cf06-620b-4df0-975d-dce8731279eb","commandName":"Keystrokes","packageName":"Keystrokes","disabled":false,"attributes":[{"name":"windowValue","value":{"type":"WINDOW","expression":"$window-15$"}},{"name":"typeOfInputStringToType","value":{"type":"STRING","string":"VALUE"}},{"name":"stringToType","value":{"type":"STRING","string":"[ALT DOWN][F4][ALT UP]"}},{"name":"delay","value":{"type":"NUMBER","number":"100"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-5$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"2"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"7cc2a77d-34c0-49f8-b9e5-bcb4a474ea6b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"272888a6-5dd6-47b8-8acd-d7056ca6fd28","commandName":"capture","packageName":"Recorder","disabled":false,"attributes":[{"name":"uiObject","value":{"type":"UIOBJECT","uiObject":{"blob":"eyJvYmpOb2RlIjp7InVuaXF1ZUlEIjoiMThjNzE2N2MtYWQyMy00MjljLThiZDktNjM0YjhkNmE1MjMxIiwiaWQiOiIiLCJuYW1lIjoiT0siLCJ2YWx1ZSI6IiIsImNsYXNzIjoiIiwicGFyZW50IjoiIiwid2luZG93VGl0bGUiOiIiLCJwYXRoIjp7Im9ialBhdGgiOlt7ImluZGV4IjoxfSx7ImluZGV4IjoxfSx7ImluZGV4IjoxfSx7ImluZGV4IjoxfSx7ImluZGV4IjoyfSx7ImluZGV4IjoxfSx7ImluZGV4IjoyfSx7ImluZGV4IjoxfV19LCJyb2xlIjoxLCJpbmRleCI6MSwibGVmdCI6MzA3LCJ0b3AiOjIwMywid2lkdGgiOjgyLCJoZWlnaHQiOjI0LCJjbGlja1giOjQxLCJjbGlja1kiOjYsImRlc2NyaXB0aW9uIjoiIiwic3RhdGVzIjoiZW5hYmxlZCxmb2N1c2FibGUsdmlzaWJsZSxzaG93aW5nLG9wYXF1ZSIsImRlZmF1bHRBY3Rpb24iOiJjbGljayIsInRlY2hub2xvZ3kiOnsidGVjaFR5cGUiOjMsInBsYXRmb3JtVHlwZSI6MTEsImFwcGxpY2F0aW9uVHlwZSI6MCwicHJvY2Vzc0lEIjoiIiwid2luSGFuZGxlIjoiIiwib2NyRW5naW5lIjpudWxsLCJpc1NpbHZlcmxpZ2h0VGVjaG5vbG9neSI6ZmFsc2V9LCJhY3Rpb25zIjpbMjQsMCwxLDIsM10sInByb3BlcnRpZXMiOltdLCJhdHRyaWJ1dGVzIjpbXSwiaXNMaW5rZWQiOmZhbHNlfSwib2JqUGFyZW50IjpudWxsLCJvYmpJdGVtIjpudWxsLCJjaGlsZHJlbiI6W10sIml0ZW1zIjpbXSwic2VhcmNoQ3JpdGVyaWEiOls4LDcsMl0sImVycm9yIjpudWxsfQ==","controlType":"BUTTON","technologyType":"JAVA","criteria":{"Path":{"enabled":true,"value":{"type":"STRING","string":"1|1|1|1|2|1|2|1"}},"Description":{"enabled":false,"value":{"type":"STRING","string":""}},"Left":{"enabled":false,"value":{"type":"STRING","string":"307"}},"Parent":{"enabled":false,"value":{"type":"STRING","string":""}},"Class Name":{"enabled":false,"value":{"type":"STRING","string":""}},"Index":{"enabled":false,"value":{"type":"STRING","string":"1"}},"Default Action":{"enabled":false,"value":{"type":"STRING","string":"click"}},"Name":{"enabled":true,"value":{"type":"STRING","string":"OK"}},"States":{"enabled":false,"value":{"type":"STRING","string":"enabled,focusable,visible,showing,opaque"}},"Top":{"enabled":false,"value":{"type":"STRING","string":"203"}},"ItemValue":{"enabled":false,"value":{"type":"STRING","string":""}},"Value":{"enabled":false,"value":{"type":"STRING","string":""}},"ItemName":{"enabled":false,"value":{"type":"STRING","string":""}},"Height":{"enabled":false,"value":{"type":"STRING","string":"24"}},"ID":{"enabled":false,"value":{"type":"STRING","string":""}},"Width":{"enabled":false,"value":{"type":"STRING","string":"82"}}}},"uiObjectWindow":{"type":"WINDOW","expression":"$window-16$"}}},{"name":"buttonAction","value":{"type":"STRING","string":"LEFTCLICK"}},{"name":"wait","value":{"type":"NUMBER","number":"5"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-16$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"2"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"f689b0cb-77d0-46f7-b2cb-65874341295f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e5bea45e-2d5d-4945-a2b2-d4906ee44814","commandName":"Keystrokes","packageName":"Keystrokes","disabled":false,"attributes":[{"name":"windowValue","value":{"type":"WINDOW","expression":"$window-2$"}},{"name":"typeOfInputStringToType","value":{"type":"STRING","string":"VALUE"}},{"name":"stringToType","value":{"type":"STRING","string":"[F10][ENTER][DOWN-ARROW][ENTER]"}},{"name":"delay","value":{"type":"NUMBER","number":"300"}}]},{"uid":"6818f9bd-f0bf-4e43-a344-50c798db5998","commandName":"closeWindow","packageName":"Window","disabled":true,"attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-2$"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-2$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"2"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"0fcf31a5-5b93-404a-b4da-e4242980ffdb","commandName":"runApp","packageName":"Application","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Config/killproc.bat"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":""}}]},{"uid":"45d1e380-20b6-4bb2-966f-8ce9adcd6ab1","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cc5fa2d7-9a23-4951-b62b-ae72ab45e06b","commandName":"closeWindow","packageName":"Window","disabled":false,"attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-3$"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-3$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"2"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"c950c0e7-7e0e-4390-b2da-50ff2bf2093d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5e6a830f-c6bd-497b-9ca6-376165b92764","commandName":"closeWindow","packageName":"Window","disabled":false,"attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-4$"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-4$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"2"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"a90ca573-c358-4cb9-b5ab-b095c1a4f62b","commandName":"if","packageName":"If","disabled":true,"children":[{"uid":"82ddcb3f-5bc6-4a00-aed0-996ed428d0a8","commandName":"Keystrokes","packageName":"Keystrokes","disabled":false,"attributes":[{"name":"windowValue","value":{"type":"WINDOW","expression":"$window-1$"}},{"name":"typeOfInputStringToType","value":{"type":"STRING","string":"VALUE"}},{"name":"stringToType","value":{"type":"STRING","string":"[ALT DOWN]c[ALT UP]"}},{"name":"delay","value":{"type":"NUMBER","number":"500"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-1$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"2"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowExists","packageName":"Window"}}]},{"uid":"621523e9-6224-442a-9864-a9f4586c5d33","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"pBoolReload"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sTaskError"},"errorLineNumber":{"type":"VARIABLE","variableName":"sTaskLineNumber"}}},{"uid":"0d2dc2a5-bbe8-4650-a10d-2011b2ed2c29","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"58986b88-2b1a-4c39-b84e-9e533aa636d9","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}}]},{"uid":"c51ae51c-1495-4a2a-bb58-9655b6b56d18","commandName":"toString","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"pBoolReload"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrReloadFlag"}},{"uid":"1b4635b9-1063-4fcf-b7fd-f8dde84267bd","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"gleb.nasiyrov@softline.com"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Робот завершил работу. Флаг перезапуска $pStrReloadFlag$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"7e15fba4-2b71-4865-bbe2-538db46f42fa","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"End of \"Заведение направлений\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}]}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"WHILE"}},{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$pBoolReload$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}},{"name":"checkConditionAtEnd","value":{"type":"BOOLEAN","boolean":true}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"recCurrentRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"datatableNaprRecords","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[],"rows":[{"values":[]}]}}},{"name":"RecordsCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"queryGetNapr2","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[View_GetNapr_Prod] WHERE eris_l="}},{"name":"datatableWrf","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"sCurrentWrf","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"recordCurrentWrf","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"dictParams","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dtConfigParams","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"name":"Name","type":"STRING"},{"name":"Value","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"recParam","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"sParamValue","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sPrevValue","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sTaskError","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sTaskLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrorLineNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pBoolReload","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"window-1","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Agfa HealthCare Enterprise Imaging","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre32_1.8.0.171\\bin\\javaw.exe","class":"SunAwtFrame","handle":"66106","isChild":false,"location":{"top":-32000,"left":-32000},"size":{"height":28,"width":160},"presetType":"NONE"}}},{"name":"window-2","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Диагностический рабочий стол*","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtFrame","handle":"66320","isChild":false,"location":{"top":0,"left":0},"size":{"height":1000,"width":1660},"presetType":"NONE"}}},{"name":"window-3","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"EMIAS - Log In*","path":"C:\\Program Files\\Internet Explorer\\iexplore.exe","class":"IEFrame","handle":"66350","isChild":false,"location":{"top":26,"left":26},"size":{"height":875,"width":1156},"presetType":"NONE"}}},{"name":"window-4","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Пациенты*","path":"C:\\Program Files\\Internet Explorer\\iexplore.exe","class":"IEFrame","handle":"66350","isChild":false,"location":{"top":-32000,"left":-32000},"size":{"height":28,"width":160},"presetType":"NONE"}}},{"name":"window-5","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Добавить продукт","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtDialog","handle":"6030352","isChild":false,"location":{"top":304,"left":602},"size":{"height":402,"width":477},"presetType":"NONE"}}},{"name":"window-15","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Добавить продукт","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtDialog","handle":"7735738","isChild":false,"location":{"top":305,"left":602},"size":{"height":402,"width":477},"presetType":"NONE"}}},{"name":"window-16","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Редактировать продукт","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre64_1.8.0.171\\bin\\javaw.exe","class":"SunAwtDialog","handle":"13765078","isChild":false,"location":{"top":385,"left":599},"size":{"height":239,"width":481},"presetType":"NONE"}}},{"name":"pBoolFirstRun","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"pStrReloadFlag","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["a097ed94-38b2-4894-a208-26e3e99bbed7","dd4b7d53-3328-4676-aa8f-661dcd9272e6"],"packages":[{"name":"Application","version":"2.0.0-20200418-005328"},{"name":"Boolean","version":"2.0.0-20200515-071408"},{"name":"Browser","version":"2.0.0-20200418-005330"},{"name":"Comment","version":"2.0.0-20200418-005342"},{"name":"DataTable","version":"2.0.0-20200418-005637"},{"name":"Database","version":"2.0.0-20200418-005345"},{"name":"Dictionary","version":"2.0.0-20200418-005349"},{"name":"Email","version":"2.0.0-20200515-071427"},{"name":"ErrorHandler","version":"2.0.0-20200418-005357"},{"name":"Excel_MS","version":"2.0.0-20200422-000103"},{"name":"If","version":"2.0.0-20200515-071441"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"Loop","version":"2.0.0-20200418-005424"},{"name":"MessageBox","version":"2.0.0-20200418-005424"},{"name":"Number","version":"2.0.0-20200418-005433"},{"name":"Recorder","version":"2.0.4-20200422-175245"},{"name":"Keystrokes","version":"2.0.0-20200418-005415"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"String","version":"3.0.0-20200418-005635"},{"name":"TaskBot","version":"2.0.0-20200417-230837"},{"name":"Window","version":"2.0.0-20200515-071753"}],"workItemTemplateName":null}