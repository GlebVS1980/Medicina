{"triggers":[],"nodes":[{"uid":"8cb09a85-4921-4613-923d-a9ae5bfa8165","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"Запуск робота \"Заведение направлений\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"c3284850-659e-47bc-886e-15865935dac5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"78b63412-a869-41bc-95e2-040b8225a1c4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"abf9943c-2a3e-4ed2-9a96-3b69e6d4d742","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"pStrLogFilePath","value":{"type":"STRING","string":"C:\\Robot\\Logs\\MED_RefInput_Log.txt"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.RefInput.ConnectVPN"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"1e5f7ac8-54fa-4f2d-ad63-368e4ba59aaf","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"6f28b839-a24d-4e32-a284-be429377d81e","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Config/MEDRobotConfig.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":true}},{"name":"sheetName","value":{"type":"STRING","string":"Assets"}},{"name":"fileAccessMode","value":{"type":"STRING","string":"READ_ONLY"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"9b6099d2-a3c6-4cab-a26b-19f4b869362e","commandName":"getWorksheetAsDataTable","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"sheetSelection","value":{"type":"STRING","string":"ActiveWorksheet"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"dtConfigParams"}},{"uid":"0dfa3d1f-7e6b-4c39-8c1f-a3eee2a94af7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"a491df90-99d3-4c11-be93-1fee29e6e440","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$recParam[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sParamValue"}},{"uid":"c0618282-cf1c-47b2-8345-e2493cdef502","commandName":"put","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dictParams"}},{"name":"key","value":{"type":"STRING","expression":"$recParam[0]$"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"sParamValue"}}],"returnTo":{"type":"VARIABLE","variableName":"sPrevValue"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recParam"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"dtConfigParams"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"93b134fa-bc77-48d3-ab0f-85305ee0a0ba","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Чтение конфигуратора"}}]},{"uid":"7611054b-990b-4240-a79c-66ea18a22590","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"09aa136c-218b-4d89-82a3-b400d6fd2962","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Получение перечня врачей из БД"}}]},{"uid":"78028a77-dd19-4eea-b7c7-15432cf63197","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionURL","value":{"type":"STRING","string":"jdbc:sqlserver://rpa02;instanceName=sqlexpress;databaseName=robot;user=sa;password=13May2020;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/mssql-jdbc-8.2.2.jre11.jar"}}]},{"uid":"57abeacd-f06f-4842-b52e-653e4e241347","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}},{"name":"query","value":{"type":"STRING","string":"Select distinct(eris_l) from [Robot].[dbo].[View_GetNapr]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"85f211e8-7a2f-4972-ac21-f0cf9c0e287a","commandName":"assign","packageName":"DataTable","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"table"}},{"name":"sourceTable","value":{"type":"TABLE","table":{"schema":[{"name":"eris_l","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}}],"returnTo":{"type":"VARIABLE","variableName":"datatableWrf"}},{"uid":"6471c6c0-4612-426a-8613-36c20b1cfdcc","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"Получен список врачей"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"8b50a765-8cc2-44a1-8d71-4f33e1e4f336","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Цикл по врачам"}}]},{"uid":"a097ed94-38b2-4894-a208-26e3e99bbed7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"044de97b-88a5-4dc1-b70f-e807e7a54e43","commandName":"insertRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableWrf"}},{"name":"positionSelection","value":{"type":"STRING","string":"lastPosition"}},{"name":"rowRecord","value":{"type":"VARIABLE","variableName":"recCurrentRow"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recCurrentRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"5b1c267a-2b9e-4d17-883b-bba4a1633acc","commandName":"deleteRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableWrf"}},{"name":"inputPosition","value":{"type":"NUMBER","number":"0"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Чтение данных из БД"}}]},{"uid":"9ecf4e99-1f35-4814-95ec-750f4ba61529","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"99725576-4ff8-4116-8e66-eccde31d38cd","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/ProgramData/AGFA/IMPAX%20Agility/com.oracle.jre32_1.8.0.171/bin/javaw.exe"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":"-jar \"C:\\ProgramData\\AGFA\\IMPAX Agility\\cache\\com.agfa.agility.netboot_1.0.1500.R812_v20180718_0743.jar\" \"eihub02apps.eris.local\""}}]},{"uid":"92a10846-9c45-4fb8-b9cb-12ff2f539cbe","commandName":"launchWebsite","packageName":"Browser","disabled":false,"attributes":[{"name":"url","value":{"type":"STRING","string":"https://ps.eris.moscow/apex/f?p=113:LOGIN_DESKTOP:14544101294074:::::"}},{"name":"browser","value":{"type":"STRING","string":"INTERNET_EXPLORER"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Запуск приложений"}}]},{"uid":"8aad44bd-b0a6-458e-98b2-e2cc3b8e2228","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Цикл по врачам"}}]},{"uid":"00d09cd3-0090-4bae-b48e-7a28353c8536","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"4f18219d-6756-4027-bbe2-0dd46228b3c0","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}},{"name":"query","value":{"type":"STRING","expression":"$queryGetNapr2$'$recordCurrentWrf[0]$'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"50166f9c-38cf-4d5a-a821-1cb7e65360cd","commandName":"assign","packageName":"DataTable","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"table"}},{"name":"sourceTable","value":{"type":"TABLE","table":{"schema":[{"name":"protocol_id","type":"STRING"},{"name":"histnum","type":"STRING"},{"name":"fio","type":"STRING"},{"name":"datpri","type":"STRING"},{"name":"wrf","type":"STRING"},{"name":"user_fullname","type":"STRING"},{"name":"eris_l","type":"STRING"},{"name":"eris_p","type":"STRING"},{"name":"kod","type":"STRING"},{"name":"schname","type":"STRING"},{"name":"diagza","type":"STRING"},{"name":"mkb_name","type":"STRING"},{"name":"person_birthday","type":"STRING"},{"name":"pol","type":"STRING"},{"name":"oms_polis_serial","type":"STRING"},{"name":"oms_polis_num","type":"STRING"},{"name":"oms_sk_name","type":"STRING"},{"name":"pet_device","type":"STRING"},{"name":"status","type":"STRING"},{"name":"cmnt","type":"STRING"},{"name":"oms_polis_custom","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}}],"returnTo":{"type":"VARIABLE","variableName":"datatableNaprRecords"}},{"uid":"e52bd9b8-cc26-4818-a514-e283508da33b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Цикл по направлениям"}}]},{"uid":"0deef8c1-d7ee-4d03-9c6c-732eb25d4458","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5422c957-3e1f-4b58-b660-804e5ced33d0","commandName":"insertRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableNaprRecords"}},{"name":"positionSelection","value":{"type":"STRING","string":"lastPosition"}},{"name":"rowRecord","value":{"type":"VARIABLE","variableName":"recCurrentRow"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recCurrentRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"connFatsql"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"5cc0c9e9-de97-4d49-ab31-335e40c9af2e","commandName":"deleteRow","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"datatableNaprRecords"}},{"name":"inputPosition","value":{"type":"NUMBER","number":"0"}}]},{"uid":"ff6b9fe4-c316-4710-8fb9-d83ace5498d3","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$datatableNaprRecords.DataTable:rowCount$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"RecordsCount"}},{"uid":"ccc90c2d-a6df-4d02-b75c-1b7866dfde1e","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Логин  $recordCurrentWrf[0]$ - $RecordsCount$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"047fafd0-765f-4ae2-a5b6-2bb44c2c7540","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Запуск подтверждения"}}]},{"uid":"dd4b7d53-3328-4676-aa8f-661dcd9272e6","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"dtNapr","value":{"type":"TABLE","expression":"$datatableNaprRecords$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.RefInput.2-SearchImaging"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"recordCurrentWrf"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"datatableWrf"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Главный процесс"}}]}],"branches":[{"uid":"c4636b6c-0655-47d6-a291-b961c1a17e16","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"381b818f-5722-4233-8ea1-eb3489bdb41e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$sTaskLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLineNumber"}},{"uid":"fd757c7e-b6df-40a0-8c40-f2c6f3040ba5","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Во время выполнения процесса произошла ошибка '$sTaskError$' в строке $sErrorLineNumber$. Обратитесь к Администратору процесса."}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sTaskError"},"errorLineNumber":{"type":"VARIABLE","variableName":"sTaskLineNumber"}}},{"uid":"0d2dc2a5-bbe8-4650-a10d-2011b2ed2c29","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"7e15fba4-2b71-4865-bbe2-538db46f42fa","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"End of \"Заведение направлений\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"queryGetNapr","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"select * from [Pt_dcm].[dbo].[petct_napr]"}},{"name":"recCurrentRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"datatableNaprRecords","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[],"rows":[{"values":[]}]}}},{"name":"RecordsCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"queryGetNapr2","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[View_GetNapr] WHERE eris_l="}},{"name":"datatableWrf","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"sCurrentWrf","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"recordCurrentWrf","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"dictParams","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dtConfigParams","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"name":"Name","type":"STRING"},{"name":"Value","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"recParam","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"sParamValue","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sPrevValue","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sTaskError","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sTaskLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrorLineNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["dd4b7d53-3328-4676-aa8f-661dcd9272e6"],"packages":[{"name":"Application","version":"2.0.0-20200418-005328"},{"name":"Browser","version":"2.0.0-20200418-005330"},{"name":"Comment","version":"2.0.0-20200418-005342"},{"name":"DataTable","version":"2.0.0-20200418-005637"},{"name":"Database","version":"2.0.0-20200418-005345"},{"name":"Dictionary","version":"2.0.0-20200418-005349"},{"name":"ErrorHandler","version":"2.0.0-20200418-005357"},{"name":"Excel_MS","version":"2.0.0-20200422-000103"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"Loop","version":"2.0.0-20200418-005424"},{"name":"MessageBox","version":"2.0.0-20200418-005424"},{"name":"Number","version":"2.0.0-20200418-005433"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"String","version":"3.0.0-20200418-005635"},{"name":"TaskBot","version":"2.0.0-20200417-230837"}],"workItemTemplateName":null}