{"triggers":[],"nodes":[{"uid":"3fb35136-d250-445e-99e0-5d707bfb2a4e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_SuperviseResearch_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"=============================\nЗапуск робота \"Визирование исследований\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"2054cb20-169c-4d35-96bb-f5d81a99d992","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"dc34384d-1062-4f88-8093-c0c498936459","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://outlook.exe"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":""}}]},{"uid":"8c5888a8-1c17-40ed-b974-ecfa321eff2f","commandName":"minimizeWindow","packageName":"Window","disabled":false,"attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-9$"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-9$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"5"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowNotExists","packageName":"Window"}}]},{"uid":"a119ba43-f6d2-426f-a197-48613c018fca","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"eca8a466-e6a0-4219-9dec-629375a556e6","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"dcdb0cbc-831a-426f-b279-c9a146852f82","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"pBoolReload"}},{"uid":"e94e341e-4ba2-4744-bf39-c38f89245206","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"pStrLogFilePath","value":{"type":"STRING","string":"C:\\Robot\\Logs\\VPN_log.txt"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.RefInput.ConnectVPN2"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"b9a323dc-7dba-4451-8272-41fa956f96d3","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6ed18d16-8c5c-4e8c-92c8-c25c42e168bc","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"074f392b-b864-40fc-bfcd-971efcd3077b","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://powershell.exe"}},{"name":"startInPath","value":{"type":"STRING","string":"C:\\Robot\\Config"}},{"name":"parameters","value":{"type":"STRING","string":".\\KillAgfaProcess.ps1"}}]},{"uid":"c4582e5f-8bfd-4a74-91b3-39701195167a","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"5"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"2875b564-4fe7-4d3d-a632-033c64b192b4","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/ProgramData/AGFA/IMPAX%20Agility/com.oracle.jre32_1.8.0.171/bin/javaw.exe"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":"-jar \"C:\\ProgramData\\AGFA\\IMPAX Agility\\cache\\com.agfa.agility.netboot_1.0.1500.R812_v20180718_0743.jar\" \"eihub02apps.eris.local\""}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-1$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"3"}}],"value":{"type":"CONDITIONAL","conditionalName":"windowNotExists","packageName":"Window"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Запуск приложений"}}]},{"uid":"447ca17c-e035-4c75-b768-99686f221a75","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d5824f32-c66f-492d-a1df-6087ef3847a6","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionSourceData"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionURL","value":{"type":"STRING","string":"jdbc:sqlserver://rpa02;instanceName=sqlexpress;databaseName=robot;user=sa;password=13May2020;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Config/mssql-jdbc-8.2.2.jre11.jar"}}]},{"uid":"dac2e946-836f-4e70-b8b0-efd2653a49a9","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionSourceData"}},{"name":"query","value":{"type":"STRING","string":"Select distinct(eris_l), eris_p from [Robot].[dbo].[View_Oms_Visir]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Чтение данных из БД"}}]},{"uid":"68f6bd3c-661c-44dd-a747-719997274fcd","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"d57a43c7-70b9-442d-a0f5-fac8246c6743","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"iStrLogin","value":{"type":"STRING","expression":"$pRecLogins{\"eris_l\"}$"}},{"key":"iStrPassword","value":{"type":"STRING","expression":"$pRecLogins{\"eris_p\"}$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/MED.SuperviseResearch.SubProcess"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pRecLogins"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionSourceData"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"e683bbc1-1460-4ee0-b23c-c85b48db7aa5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"End loop"}}]}],"branches":[{"uid":"6a51e876-96df-4a48-9668-fb4aafbe414d","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"7fd0ce6e-426c-4d21-9837-c42c83ed48f5","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$pNumErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrErrorLine"}},{"uid":"97d05797-062d-40ea-9fb8-a7e5cbce7c1e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_SuperviseResearch_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"(Main) Во время выполнения процесса произошла ошибка $pStrError$ в строке $pStrErrorLine$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"395c6dd2-f09d-4296-b793-cf4f2a77f95c","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://powershell.exe"}},{"name":"startInPath","value":{"type":"STRING","string":"C:\\Robot\\Config"}},{"name":"parameters","value":{"type":"STRING","string":".\\KillAgfaProcess.ps1"}}]},{"uid":"82407051-0595-443d-b45e-87f5709af014","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"pBoolReload"}},{"uid":"319d36e3-09dc-41e1-ae91-40cc00806c77","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"46f7db7e-9109-40ae-a72f-bd03e34129a1","commandName":"toString","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"pBoolReload"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrReloadFlag"}},{"uid":"e8f3b2ef-680a-40c8-8af2-85f83e67ed90","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$@pStrGlobalSupportMail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot MED.SuperviseResearch.Main"}},{"name":"attachmentsFilePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_RefInput_Log.txt"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Робот визирования завершил работу. Флаг перезапуска $pStrReloadFlag$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]}],"branches":[]},{"uid":"4878ef6d-08a3-49aa-b4ad-f3c744dbc8a7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"End error handler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"pStrError"},"errorLineNumber":{"type":"VARIABLE","variableName":"pNumErrorLine"}}},{"uid":"347388e2-7479-4b92-aeaa-2c93fc96c5b8","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a8044669-2e1a-4f79-a75e-3dc7d56c58a4","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionSourceData"}}]}]}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"WHILE"}},{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$pBoolReload$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}},{"name":"checkConditionAtEnd","value":{"type":"BOOLEAN","boolean":true}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"pBoolReload","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"pRecLogins","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"pStrError","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"pNumErrorLine","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"pStrErrorLine","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"pStrReloadFlag","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"window-1","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Agfa HealthCare Enterprise Imaging","path":"C:\\ProgramData\\AGFA\\IMPAX Agility\\com.oracle.jre32_1.8.0.171\\bin\\javaw.exe","class":"SunAwtFrame","handle":"66106","isChild":false,"location":{"top":-32000,"left":-32000},"size":{"height":28,"width":160},"presetType":"NONE"}}},{"name":"window-9","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"*Microsoft Outlook","path":"C:\\Program Files (x86)\\Microsoft Office\\Office12\\OUTLOOK.EXE","class":"rctrl_renwnd32","handle":"328474","isChild":false,"location":{"top":-32000,"left":-32000},"size":{"height":28,"width":160},"presetType":"NONE"}}}],"breakpoints":["2875b564-4fe7-4d3d-a632-033c64b192b4","68f6bd3c-661c-44dd-a747-719997274fcd"],"packages":[{"name":"Application","version":"2.0.0-20200418-005328"},{"name":"Boolean","version":"2.0.0-20200515-071408"},{"name":"Comment","version":"2.0.0-20200515-071418"},{"name":"Database","version":"2.0.0-20200418-005345"},{"name":"Delay","version":"2.1.0-20200515-071425"},{"name":"Email","version":"2.0.0-20200515-071427"},{"name":"ErrorHandler","version":"2.0.0-20200515-071432"},{"name":"If","version":"2.0.0-20200515-071441"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"Loop","version":"2.0.0-20200515-071511"},{"name":"Number","version":"2.0.0-20200515-071522"},{"name":"Step","version":"2.0.0-20200519-082740"},{"name":"TaskBot","version":"2.0.0-20200417-230837"},{"name":"Window","version":"2.0.0-20200515-071753"}],"workItemTemplateName":null}