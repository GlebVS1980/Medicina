{"triggers":[],"nodes":[{"uid":"f066e993-5482-4e75-b897-6e17345aff22","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"8bcd5ef4-27ee-4f46-8577-9be552a429ee","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","string":"Получение данных для входа в AGFA и диапазона дат отчета"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"048033ef-7b55-4084-9615-ec6742aeeadd","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"rpa02"}},{"name":"database","value":{"type":"STRING","string":"robot"}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"MED.KTReporting.SQLExpress","lockerName":"MED.KTReporting","attributeName":"Login"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"MED.KTReporting.SQLExpress","lockerName":"MED.KTReporting","attributeName":"Password"}}},{"name":"instance","value":{"type":"STRING","string":"sqlexpress"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"d23ee59b-3cb1-4906-8776-ef3831868f69","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2e0a3c62-469e-48e2-be8d-7a90f7c624ac","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Получить логин/пароль"}}]},{"uid":"4ec80d6b-548d-45fa-98f5-df0969fb41e0","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}},{"name":"query","value":{"type":"STRING","string":"SELECT TOP (1) [eris_l], [eris_p] FROM [Robot].[dbo].[View_GetNapr_Prod]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"28537e20-8899-475d-a70f-2aa4e2c983d4","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"43c74617-ecd2-4224-8476-d87bcdcdf73c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pRecCredentials[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrLogin"}},{"uid":"8117f4ec-179a-4eae-bcb0-0b5fbcef6d5d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pRecCredentials[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrPassword"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pRecCredentials"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"#1 - GET CREDENTIALS"}}]},{"uid":"ace64e93-53b4-441a-9c6b-7850439ab3f7","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"0eaeac01-d0dd-42db-afda-b7e11540f8b0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Получить наименьшую дату из поля [dateDICOM] таблицы [Robot].[dbo].[petct_ready]"}}]},{"uid":"9042fb2f-a77a-46f5-b021-101db2aa8b68","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}},{"name":"query","value":{"type":"STRING","string":"SELECT TOP (1) [dateDICOM] FROM [Robot].[dbo].[petct_ready] ORDER BY [dateDICOM] ASC"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a5c80fa5-cf2a-48f0-b06a-4352a762a396","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"db3ba765-9979-43df-bac3-427143fa05d6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pRecCredentials[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrDateFrom"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pRecCredentials"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"5c7cbd4c-cf92-410b-8830-911020a306c7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Получить наибольшую дату из поля [dateDICOM] таблицы [Robot].[dbo].[petct_ready]"}}]},{"uid":"8e5ae5d5-1bd4-461f-8b4f-33d16557d9a3","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}},{"name":"query","value":{"type":"STRING","string":"SELECT TOP (1) [dateDICOM] FROM [Robot].[dbo].[petct_ready] ORDER BY [dateDICOM] DESC"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ffdc6a6a-3fb1-4d24-bfb2-b42c95010d24","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"0a0af806-40c4-48fd-a859-77c010819889","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pRecCredentials[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrDateTo"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pRecCredentials"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"#2 - GET DATES INTERVAL"}}]},{"uid":"b8641c09-c9e3-45b1-855c-af4b2022d254","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fbac009c-bd03-4bf8-a56e-030c78b8886e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Получить все даты из поля [dateDICOM] таблицы [Robot].[dbo].[petct_ready]"}}]},{"uid":"54b8b695-4136-4d40-a0b2-1ea61409d550","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}},{"name":"query","value":{"type":"STRING","string":"SELECT DISTINCT [dateDICOM] FROM [Robot].[dbo].[petct_ready] ORDER BY [dateDICOM] ASC"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"7c91713c-0725-4e49-b9b3-a8b442a91e2a","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"3a521bf4-5cb3-4db7-94ab-29b355729502","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5041d7fc-6b05-4d31-aeca-8f1ef0a584b2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pRecCredentials[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrDates"}}],"branches":[{"uid":"7faba0d6-3464-4dd9-bef3-0f856fa3af1c","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7d4d95c9-f0a5-41ae-8463-fa1bc953a44a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$oStrDates$|$pRecCredentials[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrDates"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$oStrDates$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"pRecCredentials"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"#2.2 - GET DATES LIST"}}]},{"uid":"40267c61-f12d-4de2-bb33-9e70c2b9ee81","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sessionCredentials"}}]}],"branches":[{"uid":"13adf5f1-baa8-4a61-9327-5eec925051fa","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"98e428d4-779c-4377-acc2-d1545088bbe7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Ошибка \"$pStrErrorMessage$\" в строке $pNumErrorLineNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"oStrResult"}},{"uid":"173ef594-8935-404d-93db-04678bdcbe88","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$oStrResult$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"pStrErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"pNumErrorLineNumber"}}},{"uid":"ce538563-bf16-45c6-9acd-ad2d2d43cd4b","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"7b012d87-a3fd-4783-806c-4ce5c84bb07a","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Данные для входа получены (Login=$oStrLogin$ Password=$oStrPassword$)"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"306249b0-e54e-49b1-8013-4d99c458c9f6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Данные для входа получены (Login=$oStrLogin$)"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"3c17ee48-e6ed-4abb-82de-99843c352d45","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Диапазон дат отчета: $oStrDateFrom$ - $oStrDateTo$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]},{"uid":"852f5746-eec0-4b3d-ac46-ed7e05f28e51","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Robot/Logs/MED_KTReporting_Log.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Перечень дат отчета: $oStrDates$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UNICODE"}}]}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"oStrResult","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"pStrErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pNumErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"pTableCredentials","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"pRecCredentials","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"oStrLogin","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"oStrPassword","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"oStrDateFrom","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"oStrDateTo","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"oStrDates","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Comment","version":"2.0.0-20200515-071418"},{"name":"Database","version":"2.0.0-20200515-071421"},{"name":"ErrorHandler","version":"2.0.0-20200515-071432"},{"name":"If","version":"2.0.0-20200624-041646"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"Loop","version":"2.0.0-20200515-071511"},{"name":"Number","version":"2.0.0-20200515-071522"},{"name":"Step","version":"2.0.0-20200624-103754"},{"name":"String","version":"3.0.0-20200515-071729"}],"workItemTemplateName":null}