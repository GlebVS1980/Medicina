{"triggers":[],"nodes":[{"uid":"5313ac51-51a2-46c0-a4ff-e4716bd0f499","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionURL","value":{"type":"STRING","string":"jdbc:sqlserver://rpa02;instanceName=sqlexpress;databaseName=robot;user=sa;password=13May2020;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f7e57d71-e8c6-4e0d-8645-440758d73f6e","commandName":"connect","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","expression":"$pStrDbSessionName$"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionURL","value":{"type":"STRING","string":"jdbc:sqlserver://rpa02;instanceName=sqlexpress;databaseName=robot;user=sa;password=13May2020;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"d209b09a-a22c-41c8-95e7-75d96d916916","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","expression":"$pStrDbSessionName$"}},{"name":"query","value":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[View_GetRadioTer] WHERE [protocol_id] < '100000'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/rpadev2/Desktop/TableDataUnicode.csv"}},{"name":"encodingType","value":{"type":"STRING","string":"UTF8"}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]},{"uid":"69dcd3e6-9db5-4609-b5ef-386692137969","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","expression":"$pStrDbSessionName$"}},{"name":"query","value":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[View_GetRadioTer] WHERE [protocol_id] < '100000'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/rpadev2/Desktop/TableDataUnicode.csv"}},{"name":"encodingType","value":{"type":"STRING","string":"UTF8"}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]},{"uid":"05f114cf-25eb-4ec3-8856-099c58eba377","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","expression":"$pStrDbSessionName$"}},{"name":"query","value":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[radio_ter_test] WHERE [protocol_id] < '100000'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/rpadev2/Desktop/TableDataUnicode.csv"}},{"name":"encodingType","value":{"type":"STRING","string":"UTF8"}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]},{"uid":"d776a188-61d0-4417-bc3f-6ec277908f08","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[radio_ter_test]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/rpadev2/Desktop/TableDataUnicode.csv"}},{"name":"encodingType","value":{"type":"STRING","string":"UTF8"}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]},{"uid":"a45f10de-72c1-4852-b2d8-248e161385fc","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"SELECT * FROM [Robot].[dbo].[View_GetRadioTer]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/rpadev2/Desktop/TableDataUnicode.csv"}},{"name":"encodingType","value":{"type":"STRING","string":"UTF8"}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]},{"uid":"78a479a4-313a-477f-842f-a2e6dcd9569e","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"uid":"527f259c-7c06-4f2b-a02f-64fcccecb635","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Check   $pStrSoapAnswer$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6685754f-10d3-43f1-a31c-5214adeb3fe5","commandName":"soapCommand","packageName":"SoapWebService","disabled":true,"attributes":[{"name":"wsdlUriOption","value":{"type":"STRING","string":"uri"}},{"name":"wsdlUri","value":{"type":"STRING","string":"http://192.168.202.2/api?WSDL"}},{"name":"uri","value":{"type":"STRING","string":""}},{"name":"serviceName","value":{"type":"STRING","string":"Api_SoapManagerService"}},{"name":"portName","value":{"type":"STRING","string":"Api_SoapManagerPort"}},{"name":"soapVersion","value":{"type":"STRING","string":"SOAP 1.1 Protocol"}},{"name":"operation","value":{"type":"STRING","string":"patientGetProtocolList"}},{"name":"radioValue","value":{"type":"STRING","string":"completeResponse"}},{"name":"requestParameters","value":{"type":"PROPERTIES","properties":[{"type":"STRING","name":{"type":"STRING","string":"iCardNum"},"value":{"type":"STRING","expression":"$pRecTableRow{histnum}$"},"enabled":true}]}},{"name":"authenticationMode","value":{"type":"STRING","string":"Basic"}},{"name":"basicUserName","value":{"type":"STRING","string":"RPA_softline"}},{"name":"basicPassword","value":{"type":"STRING","string":"FXk3rw2V"}},{"name":"scope","value":{"type":"STRING","string":"completeResponse"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrSoapAnswer"}},{"uid":"5ffe52e5-3c7e-4a90-b2e8-d9d2ad9029be","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Получение /item/pdf ссылки"}}]},{"uid":"21578609-1a89-4599-8b4c-40be43c20af8","commandName":"startSession","packageName":"XML","disabled":true,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XmlSoapAnswer"}},{"name":"inputType","value":{"type":"STRING","string":"text"}},{"name":"data","value":{"type":"STRING","expression":"$pStrSoapAnswer$"}}]},{"uid":"74567a5a-b88f-4c3c-8348-ff269d3763df","commandName":"executeXPath","packageName":"XML","disabled":true,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XmlSoapAnswer"}},{"name":"xPath","value":{"type":"STRING","expression":"//item[sProtocolName[contains(text(),'Выписной эпикриз (радиотерапия)')] and sDate[contains(text(),'$pRecTableRow{dt}$')]]/sPdfLink"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrPdfLink"}},{"uid":"f6117b45-c65d-4ae7-8ef2-b7cc6c1e15e1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Загрузка файла"}}]},{"uid":"602ed04f-4b2a-4744-b59d-400a58fd9b26","commandName":"if","packageName":"If","disabled":true,"children":[{"uid":"44ef9fe4-8df6-4a37-afea-506e88e53926","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"TODO: если ссылка битая?"}}]},{"uid":"01e3e9d6-d5c8-4cb4-96c9-3c42a3fdaf01","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"C:\\TEMP\\$pRecTableRow{\"protocol_id\"}$($pRecTableRow{fio}$).pdf"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrPdfFilePath"}},{"uid":"4bccee28-253b-4f5f-a43a-1dad3fd974a6","commandName":"downloadFile","packageName":"Browser","disabled":false,"attributes":[{"name":"url","value":{"type":"STRING","expression":"$pStrPdfLink$"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$pStrPdfFilePath$"}},{"name":"overwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[{"uid":"41bbdb45-9bfe-4e96-ac68-cdf569e48f13","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"717d9ea1-f362-4f3f-814e-adb9e9e978b5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Ссылка на файл пуста"}}]},{"uid":"7b1a8999-724c-46ca-ae48-8f9006bd6dcf","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Emias%201.SetStatus"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6e85c683-5c92-4ba5-a994-efa0fefef727","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Строка пациента (для отчета)"}}]},{"uid":"6517dc0a-b1db-4259-b682-be77192a5f93","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pStrHtmlTableReport$<tr><td>$pRecTableRow{protocol_id}$</td><td>$pRecTableRow{histnum}$</td><td>$pRecTableRow{fio}$</td><td>$pRecTableRow{nib}$</td><td>5</td><td>Ошибка: отсутствует pdf-файл</td></tr>"}}],"returnTo":{"type":"VARIABLE","variableName":"pStrHtmlTableReport"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$pStrPdfLink$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"pStrDbSessionName","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"GetRadioTer"}},{"name":"pStrSoapAnswer","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pRecTableRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"pStrPdfLink","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"pStrPdfFilePath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"pStrHtmlTableReport","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Browser","version":"2.0.0-20200624-041611"},{"name":"Comment","version":"2.0.0-20200515-071418"},{"name":"Database","version":"2.0.0-20200515-071421"},{"name":"If","version":"2.0.0-20200624-041646"},{"name":"MessageBox","version":"2.1.0-20210227-025722"},{"name":"SoapWebService","version":"3.0.0-20200624-042140"},{"name":"String","version":"3.0.0-20200515-071729"},{"name":"TaskBot","version":"2.0.0-20200519-082744"},{"name":"XML","version":"2.0.0-20200624-042200"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}